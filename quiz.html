<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Quiz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f9;
        }

        .quiz-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
            padding: 20px;
            box-sizing: border-box;
        }

        .question {
            margin-bottom: 20px;
        }

        .options {
            list-style-type: none;
            padding: 0;
        }

        .option {
            background-color: #e9e9f0;
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .option:hover {
            background-color: #d0d0e1;
        }

        .option.selected {
            background-color: #b0b0d1;
        }

        .option.correct {
            background-color: #a0d1b0;
        }

        .option.incorrect {
            background-color: #d1a0a0;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background-color: #5a5af3;
            color: white;
            cursor: pointer;
        }

        button:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .quiz-container {
                padding: 15px;
            }

            button {
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
<div class="quiz-container">
    <div id="quiz">
        <!-- Dynamic content goes here -->
    </div>
    <div class="navigation">
        <button id="prev" onclick="prevQuestion()" disabled>Previous</button>
        <button id="next" onclick="nextQuestion()">Next</button>
        <button id="submit" onclick="submitQuiz()" style="display: none;">Submit</button>
    </div>
</div>

<script>
    const questions = [
        {
            "question": "What does HTML stand for?",
            "options": [
                "Hypertext Markup Language",
                "High-Level Text Markup Language",
                "Hyperlink and Text Markup Language",
                "Hypertext Machine Language"
            ],
            "answer": [0]
        },
        {
            "question": "Which of the followings are used to build web pages?",
            "options": [
                "HTML",
                "CSS",
                "PHP",
                "C#"
            ],
            "answer": [0, 1]
        },
        {
            "question": "What are the purpose of JavaScript in web development?",
            "options": [
                "To structure content",
                "To style content",
                "To add interactivity",
                "To manage databases"
            ],
            "answer": [2]
        },
        {
            "question": "Which HTML element is used for the largest heading?",
            "options": [
                "h1",
                "h6",
                "header",
                "title"
            ],
            "answer": [0]
        },
        {
            "question": "What are frontend frameworks/libraries?",
            "options": [
                "React",
                "Express",
                "Angular",
                "Laravel"
            ],
            "answer": [0, 2]
        },
        {
            "question": "Which of the followings are a JavaScript framework?",
            "options": [
                "Django",
                "React",
                "Ruby on Rails",
                "Next",
            ],
            "answer": [1, 3]
        },
        {
            "question": "What are the backend languages?",
            "options": [
                "JavaScript",
                "CSS",
                "PHP",
                "HTML"
            ],
            "answer": [2]
        },
        {
            "question": "Which protocols are commonly used for secure communication over a computer network?",
            "options": [
                "HTTP",
                "FTP",
                "HTTPS",
                "SMTP"
            ],
            "answer": [2]
        }
    ];

    let currentQuestionIndex = 0;
    let viewCorrectAnswer = false;
    let selectedOptions = Array(questions.length).fill([]);

    function loadQuestion() {
        const quizDiv = document.getElementById('quiz');
        const question = questions[currentQuestionIndex];
        console.log(selectedOptions, selectedOptions[currentQuestionIndex], currentQuestionIndex)
        quizDiv.innerHTML = `
                <div class="question">${question.question}</div>
                <ul class="options">
                    ${question.options.map((option, index) => `
                        <li
                        class="option ${viewCorrectAnswer
            ? question.answer.includes(index)
                ? 'selected'
                : ''
            : selectedOptions[currentQuestionIndex].includes(index)
                ? 'selected'
                : ''}"
                        onclick="selectOption(${index})"
                        >
                            ${option}
                        </li>
                    `).join('')}
                </ul>
            `;

        document.getElementById('prev').disabled = currentQuestionIndex === 0;
        document.getElementById('next').style.display = currentQuestionIndex === questions.length - 1 ? 'none' : 'inline-block';
        document.getElementById('submit').style.display = currentQuestionIndex === questions.length - 1 ? 'inline-block' : 'none';
    }

    function selectOption(index) {
        console.log(currentQuestionIndex, selectedOptions[currentQuestionIndex], selectedOptions)
        let current = [...selectedOptions[currentQuestionIndex]]
        if (selectedOptions[currentQuestionIndex].includes(index)) {
            selectedOptions[currentQuestionIndex] = selectedOptions[currentQuestionIndex].filter(i => i !== index)
        } else {
            current.push(index)
            selectedOptions[currentQuestionIndex] = current
        }
        loadQuestion();
    }

    function nextQuestion() {
        if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        }
    }

    function prevQuestion() {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
        }
    }

    function calculateScore(correctAnswers, userAnswers) {
        return correctAnswers.map((correct, index) => {
            const user = userAnswers[index];
            const correctSet = new Set(correct);
            let scores = 0;

            user.forEach(answer => {
                if (correctSet.has(answer)) {
                    scores++;
                }
            });

            return Math.round(scores / correct.length * 10) / 10;
        }).reduce((partialSum, a) => partialSum + a, 0);
    }

    function submitQuiz() {
        let score = calculateScore(questions.map(q => q.answer), selectedOptions)

        const quizDiv = document.getElementById('quiz');
        quizDiv.innerHTML = `<div class="question">You scored ${score} out of ${questions.length}</div>`;
        document.querySelector('.navigation').style.display = 'none';
    }

    function showOrHideCorrectAnswer() {
        viewCorrectAnswer = !viewCorrectAnswer;
        loadQuestion();
    }

    loadQuestion();
</script>
</body>
</html>